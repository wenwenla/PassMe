{% extends "ticks/base.html" %}
{% load static %}
{% block resource %}<link href="{% static "timeline.css" %}" rel="stylesheet">{% endblock %}
{% block title %}日常瞎写系统{% endblock %}
{% block js %}
 <script>
    $.ajaxSetup({
        data: {csrfmiddlewaretoken: '{{ csrf_token }}'}
    });

    $(document).ready(function () {
        $("#wake_up_btn").click(function () {
            var content = $("#wake_up_input").val();
            if (!content) {
                alert("填点啥吧，不然我咋知道你有没有睡醒啊。");
                return;
            }
            $.post("/ticks/wakeup/", {"content": content}, function (data) {
                if (data["status"] === "ok") {
                    location.reload();
                } else {
                    alert(data["message"]);
                }
            })
        });
        $("#sleep_btn").click(function () {
            var content = $("#sleep_input").val();
            if (!content) {
                alert("睡觉了，说点啥吧？");
                return;
            }
            $.post("/ticks/sleep/", {"content": content}, function (data) {
                if (data["status"] === "ok") {
                    location.reload();
                } else {
                    alert(data["message"]);
                }
            })
        });
        $("#other_btn").click(function () {
            var content = $("#other_input").val();
            if (!content) {
                alert("你想说啥啊。。");
                return;
            }
            $.post("/ticks/other/", {"content": content}, function (data) {
                if (data["status"] === "ok") {
                    location.reload();
                } else {
                    alert(data["message"]);
                }
            })
        });
    });
</script>
{% endblock %}

{% block content %}
<!--模态框-->
<div class="modal fade" id="add" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">打卡内容</h4>
            </div>
            <div class="modal-body">
                <div class="row" style="padding: 20px">
                    <div class="col-sm-8 col-sm-offset-2">
                        <div class="input-group">
                            <input type="text" class="form-control" id="wake_up_input">
                            <span class="input-group-btn">
                                <button class="btn btn-primary" id="wake_up_btn" type="button">起床啦~</button>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="row" style="padding: 20px">
                    <div class="col-sm-8 col-sm-offset-2">
                        <div class="input-group">
                            <input type="text" class="form-control" id="sleep_input">
                            <span class="input-group-btn">
                                <button class="btn btn-primary" id="sleep_btn" type="button">睡觉了~</button>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="row" style="padding: 20px">
                    <div class="col-sm-8 col-sm-offset-2">
                        <div class="input-group">
                            <input type="text" class="form-control" id="other_input">
                            <span class="input-group-btn">
                                <button class="btn btn-primary" id="other_btn" type="button">写点啥~</button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

{% include "ticks/nav.html" %}

<div class="container">
    <div id="timeline">
        <div class="row timeline-movement timeline-movement-top">
            <div class="timeline-badge timeline-future-movement">
                <a href="#" data-toggle="modal" data-target="#add">
                    <span class="glyphicon glyphicon-plus"></span>
                </a>
            </div>
            <div class="timeline-badge timeline-filter-movement">
                <a href="#"><span class="glyphicon glyphicon-adjust"></span></a>
            </div>
        </div>

        {% for item in data %}
            <div class="row timeline-movement">
                <div class="timeline-badge">
                    <div class="timeline-balloon-date-day">{{ item.date | date:'d'}}</div>
                    <div class="timeline-balloon-date-month">{{ item.date | date:'M'}}</div>
                </div>
                {% if item.self %}
                    <div class="col-sm-5 col-xs-5 col-md-6 col-lg-6 timeline-item">
                        <div class="row">
                            <div class="col-sm-11 col-xs-11 col-lg-11">
                                <div class="timeline-panel credits">
                                    <ul class="timeline-panel-ul">
                                        <li><span class="importo">{{ item.title }}</span></li>
                                        <li><span class="causale">{{ item.content }} <br> from {{ item.name }}</span>
                                        </li>
                                        <li>
                                            <p>
                                                <small class="text-muted"><i class="glyphicon glyphicon-time"></i>
                                                    {{ item.time | time:'H:i:s' }}
                                                </small>
                                            </p>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                {% else %}
                    <div class="col-sm-5 col-xs-5 col-md-6 col-lg-6
                    col-sm-offset-7 col-xs-offset-7 col-md-offset-6 col-lg-offset-6 timeline-item">
                        <div class="row">
                            <div class="col-sm-11 col-xs-11 col-md-11 col-lg-11
                            col-sm-offset-1 col-xs-offset-1 col-md-offset-1 col-lg-offset-1">
                                <div class="timeline-panel debits">
                                    <ul class="timeline-panel-ul">
                                        <li><span class="importo">{{ item.title }}</span></li>
                                        <li><span class="causale">{{ item.content }} <br> from {{ item.name }}</span>
                                        </li>
                                        <li>
                                            <p>
                                                <small class="text-muted"><i class="glyphicon glyphicon-time"></i>
                                                    {{ item.time | time:'H:i:s' }}
                                                </small>
                                            </p>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}